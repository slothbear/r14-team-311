"use strict";angular.module("frontendApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap","ui.router","restangular"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("dashboard",{url:"/",templateUrl:"views/dashboard.html",controller:"DashboardCtrl"})}]).config(["RestangularProvider",function(a){a.setRestangularFields({id:"_id"}),a.setRequestInterceptor(function(a,b,c){"put"===b&&(a._id=void 0);var d;return("post"===b||"put"===b||"patch"===b)&&(d={},"s"===c[c.length-1]?d[c.substring(0,c.length-1)]=a:d=a),d}),a.setResponseExtractor(function(a,b){var c;return"getList"===b?(c=a.data,a.metadata&&(c.metadata=a.metadata)):c=a,c})}]),angular.module("frontendApp").controller("MainCtrl",["$scope","$modal",function(a,b){a.openAbout=function(){b.open({templateUrl:"views/about.html",controller:["$scope","$modalInstance",function(a,b){a.close=function(){b.dismiss("cancel")}}]})}}]),angular.module("frontendApp").controller("StatsCtrl",["$scope","Restangular",function(a,b){a.stats={},b.one("stats","monthly").getList().then(function(b){for(var c=0;c<b.length;c++){var d=b[c];for(var e in d)a.stats[e]=a.stats[e]||[],a.stats[e].push(d[e])}for(var f in a.stats){var g=a.stats[f];g.length<=1&&a.stats[f].unshift(0)}})}]),angular.module("frontendApp").controller("RankingCtrl",["$scope","Restangular",function(a,b){b.all("users").getList().then(function(c){a.leader=c[0],b.one("user_stats",a.leader.login).getList("monthly").then(function(b){a.leaderStats=b[b.length-1]}),c.length>1&&(a.rest=c.slice(1,c.length))})}]),angular.module("frontendApp").controller("LiveStreamCtrl",["$scope","$timeout","Restangular",function(a,b,c){var d=0;!function e(){c.all("events").getList({timestamp:d}).then(function(c){for(var f=0;f<c.length;f++){var g=c[f];if(g.created_at=moment(g.created_at),"push"===g.type){g.isCollapsed=!0;for(var h=[],i=[],j=0;j<g.data.commits.length;j++){var k=g.data.commits[j];k.timestamp=moment(k.timestamp),2>j?i.push(k):h.push(k)}g.data.more_commits=h,g.data.head_commits=i}a.events&&a.events.unshift(g)}d||(d=c[0].created_at.unix()),a.events||(a.events=c),b(e,1e4)})}()}]),angular.module("frontendApp").directive("sparkline",function(){return{restrict:"A",link:function(a,b,c){a.$watch(c.sparkline,function(c){a.statsData=c,b.sparkline(a.statsData,d)},!0);var d=b.data();d.type=d.type||"bar",d.disableHiddenCheck=!0,d.resize&&$(window).resize(function(){b.sparkline(a.statsData,d)})}}}),angular.module("frontendApp").controller("DashboardCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);